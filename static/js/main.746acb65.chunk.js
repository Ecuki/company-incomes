(this["webpackJsonpcompany-incomes"]=this["webpackJsonpcompany-incomes"]||[]).push([[0],{593:function(e,t,n){e.exports=n(867)},598:function(e,t,n){},600:function(e,t,n){},689:function(e,t,n){},690:function(e,t,n){},692:function(e,t,n){},863:function(e,t,n){},864:function(e,t,n){},865:function(e,t,n){},866:function(e,t,n){},867:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n.n(a),r=n(21),o=n.n(r),i=(n(598),n(197)),l=n.n(i),s=n(363),m=n(37),u=n(122),f=n(124),d=n(551),p=(n(600),n(535)),h=n.n(p);function v(e){var t=e.companies,n=(e.loading,Object(a.useState)(t)),r=Object(m.a)(n,2),o=r[0],i=r[1],l=Object(a.useRef)(!0);Object(a.useEffect)((function(){l.current?l.current=!1:i(t)}),[t]);var s=[{title:"ID",field:"id",type:"numeric"},{title:"Name",field:"name"},{title:"City",field:"city"},{title:"Total income",field:"income",type:"numeric"}].map((function(e){return Object(d.a)({render:function(t){return c.a.createElement(u.b,{to:"/".concat(t.id)},e.lookup?e.lookup[t[e.field]]:t[e.field])}},e)}));return c.a.createElement(h.a,{title:"Company Incomes",columns:s,data:o,isLoading:!o[0],options:{headerStyle:{backgroundColor:"#9933ff",color:"#fff",fontWeight:600},activeSortIcon:{opacity:.5},inactiveSortIcon:{opacity:.7}}})}n(689);function E(){return c.a.createElement("div",{id:"spinner",className:"spinner"})}n(690);function b(e){var t=e.className,n=e.text,a=e.data;return c.a.createElement("div",{className:"company__details company__".concat(t)},c.a.createElement("span",null,n),c.a.createElement("span",null,""!==a?a:c.a.createElement(E,null)))}var y=n(367),g=n.n(y);n(691),n(692);function j(e){var t=e.date,n=e.onChange,a=new Date(t.start),r=new Date(t.end),o=new Date;return c.a.createElement("div",{className:"calendar"},c.a.createElement("div",{className:"calendar__element"},c.a.createElement("span",null,"Start:"),c.a.createElement(g.a,{selected:a,onChange:function(e){return n(e,r)},selectsStart:!0,startDate:a,endDate:r,maxDate:r})),c.a.createElement("div",{className:"calendar__element"},c.a.createElement("span",null,"End:"),c.a.createElement(g.a,{selected:r,onChange:function(e){return n(a,e)},selectsEnd:!0,startDate:a,endDate:r,minDate:a,maxDate:o})))}var O=n(542);n(863);function k(e){var t=e.data,n=Object(a.useState)(!0),r=Object(m.a)(n,2),o=r[0],i=r[1],l=Object(a.useState)(t),s=Object(m.a)(l,2),u=s[0],f=s[1],d=Object(a.useRef)(!0);return Object(a.useEffect)((function(){d.current?d.current=!1:(f(t),i(!1))}),[t]),c.a.createElement("div",{className:"chart"},o?c.a.createElement(E,null):c.a.createElement(O.a,{className:"myChart",data:u,keys:["value"],indexBy:"date",margin:{top:10,right:30,bottom:30,left:90},colors:"#222299",borderColor:{from:"color",modifiers:[["darker",1.6]]},axisTop:null,axisRight:null,layout:"horizontal",maxValue:Math.max.apply(Math,u.map((function(e){return e.value})))+5e3,axisBottom:{tickSize:5,tickPadding:5,tickValues:7,tickRotation:0,legend:null,legendPosition:"end",legendOffset:32,format:".0s"},axisLeft:{tickSize:5,tickPadding:5,tickRotation:0,legend:null,legendPosition:"middle",legendOffset:-60},padding:.3,labelSkipWidth:12,labelSkipHeight:12,labelTextColor:"transparent",animate:!0,motionStiffness:90,motionDamping:15}))}function x(e){return e.reduce((function(e,t){return e+1*t.value}),0).toFixed(2)}n(864);var w=function(e){var t,n=e.company,r=Object(a.useState)({id:"",name:"",city:"",incomes:"",income:""}),o=Object(m.a)(r,2),i=o[0],l=o[1],s=Object(a.useState)({average:"",total:"",months:[{income:"",date:""}]}),f=Object(m.a)(s,2),d=f[0],p=f[1],h=[["name","Name:",i.name],["ID","ID:",i.id],["city","City:",i.city],["income","Total income:",i.income],["income-average","Average incomes:",d.average],["income-period","Income for period:",d.total]],v=Object(a.useState)({start:new Date((new Date).setHours(0,0,0,0)).setDate(1),end:(new Date).getTime()}),E=Object(m.a)(v,2),y=E[0],g=E[1];t=function(){if(n){var e=w();p(e)}},Object(a.useEffect)(t,[y]),function(e){Object(a.useEffect)(e,[])}((function(){if(n){l(n);var e=w();p(e)}}));var O=function(e){var t=e.map((function(e){return e.date.slice(0,7)}));return Array.from(new Set(t)).map((function(t){var n=0;return e.map((function(e){return n+=e.date.slice(0,7)===t?1*e.value:0})),{value:1*n.toFixed(2),date:t}}))},w=function(){var e=n.incomes,t=e.filter((function(e){var t=new Date(e.date).getTime();return t>=y.start&&t<y.end})),a=1*x(t),c=(a/t.length).toFixed(2);return{average:c>0?c:0,total:a>0?a:0,months:O(e)}};return c.a.createElement("div",{className:"company"},c.a.createElement(u.b,{to:"/company-incomes"},c.a.createElement("i",{className:"material-icons"},"arrow_back"),"Back"),c.a.createElement("h2",{className:"company__header"},"Company details"),h.map((function(e){return c.a.createElement(b,{key:e[0],className:e[0],text:e[1],data:e[2]})})),c.a.createElement(j,{date:y,onChange:function(e,t){g({start:e,end:t})}}),c.a.createElement("h2",{className:"company__header"},"Monthly incomes"),c.a.createElement(k,{data:d.months}))};n(865);function D(){return c.a.createElement("div",{className:"page-not-found"},c.a.createElement("h1",null,"Page Not Found"),c.a.createElement("div",null,"404"),c.a.createElement("p",null,"Sorry, there is nothing to see here."),c.a.createElement("p",null,c.a.createElement(u.b,{to:"/"},"Back to Home")))}n(866);var S=function(){var e,t="https://recruitment.hal.skygate.io/companies",n="https://recruitment.hal.skygate.io/incomes/",r=Object(a.useState)(!1),o=Object(m.a)(r,2),i=o[0],d=o[1],p=Object(a.useState)(!1),h=Object(m.a)(p,2),E=h[0],b=h[1],y=Object(a.useState)([]),g=Object(m.a)(y,2),j=g[0],O=g[1];function k(){return(k=Object(s.a)(l.a.mark((function e(){var a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,d(!0),e.next=4,fetch(t);case 4:return e.next=6,e.sent.json();case 6:return a=e.sent,e.next=9,Promise.all(a.map(function(){var e=Object(s.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n+t.id);case 2:return e.next=4,e.sent.json();case 4:return a=e.sent,t.income=x(a.incomes),t.incomes=a.incomes.sort((function(e,t){return new Date(e.date)-new Date(t.date)})),e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 9:(c=e.sent).sort((function(e,t){return 1*t.income-1*e.income})),O(c),d(!1),e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(0),b(e.t0),E;case 19:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}return e=function(){!function(){k.apply(this,arguments)}()},Object(a.useEffect)(e,[]),c.a.createElement(u.a,null,c.a.createElement(f.c,null,c.a.createElement(f.a,{path:"/company-incomes",exact:!0,component:function(){return c.a.createElement(v,{companies:j})}}),c.a.createElement(f.a,{path:"company-incomes/:id",component:function(e){return c.a.createElement(w,{company:(t=e.match.params.id,j.filter((function(e){return 1*e.id===1*t}))[0]),loading:i});var t}}),c.a.createElement(f.a,{path:"company-incomes/",component:D})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(S,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[593,1,2]]]);
//# sourceMappingURL=main.746acb65.chunk.js.map